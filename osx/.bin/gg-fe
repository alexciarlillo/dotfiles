#!/bin/bash

# Tmux equivalent of gg-fe WezTerm script
# Creates a 3-pane layout: gg (top), gcdev (middle), gctestsdev (bottom)

# Source the workspace helper
source ~/.dotfiles/universal/.config/tmux/tmux-workspace-helper

# Create workspace (window or session)
WINDOW=$(tmux_create_workspace "gg-fe")
SESSION_NAME="gg-fe" # Used for attach if outside tmux

# Start with the first pane (will become gctestsdev pane at bottom)
# We will make this 20 Lines
tmux split-window -t $WINDOW -v -l 20
# Now we have: pane 1 (top), pane 2 (bottom 20 lines)

# Split the top pane to create the middle pane (gcdev 40 lines)
tmux split-window -t $WINDOW.1 -v -l 40

# Now we have: pane 1 (top), pane 3 (middle 40 lines), pane 2 (bottom 20 lines)

# Set up the top pane (gg)
tmux send-keys -t $WINDOW.1 'gg' Enter
# Set up the middle pane (gcdev 40 lines)
tmux send-keys -t $WINDOW.2 'gcdev --env.disableHmr --env.admin ' # Leave command ready
# Set up the bottom pane (gctestsdev)
tmux send-keys -t $WINDOW.3 'gctestsdev ' # Leave command ready

# Now we have: pane 1 (top gg), pane 2 (middle gcdev), pane 3 (bottom gctestsdev)

# Focus on the bottom pane (gctestsdev)
tmux select-pane -t $WINDOW.2

# Attach to session if we're outside tmux
tmux_attach_if_outside "$SESSION_NAME"

